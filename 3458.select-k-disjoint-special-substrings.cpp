#\n# @lc app=leetcode id=3458 lang=cpp\n#\n# [3458] Select K Disjoint Special Substrings\n#\n\n# @lc code=start\nclass Solution {\npublic:\n    bool maxSubstringLength(string s, int k) {\n        int n = s.length();\n        \n        // Precompute first and last occurrence of each character\n        vector<int> first(26, n), last(26, -1);\n        for (int i = 0; i < n; i++) {\n            int c = s[i] - 'a';\n            first[c] = min(first[c], i);\n            last[c] = i;\n        }\n        \n        // Find all special substrings\n        vector<pair<int, int>> intervals; // {end, start}\n        \n        for (int i = 0; i < n; i++) {\n            for (int j = i; j < n; j++) {\n                // Skip if it's the entire string\n                if (i == 0 && j == n - 1) continue;\n                \n                // Check if [i, j] is a special substring\n                bool valid = true;\n                for (int pos = i; pos <= j; pos++) {\n                    int c = s[pos] - 'a';\n                    if (first[c] < i || last[c] > j) {\n                        valid = false;\n                        break;\n                    }\n                }\n                \n                if (valid) {\n                    intervals.push_back({j, i});\n                }\n            }\n        }\n        \n        // Sort by end position\n        sort(intervals.begin(), intervals.end());\n        \n        // Greedy interval scheduling\n        int count = 0;\n        int last_end = -1;\n        for (auto& p : intervals) {\n            if (p.second > last_end) {\n                count++;\n                last_end = p.first;\n            }\n        }\n        \n        return count >= k;\n    }\n};\n# @lc code=end